## The below steps are valid for NHPs (Non-human great apes)
# for getting the desired file type columns, with only the chr information
rm *.dat
cat g4s_inNewRegionsT2T.bed | awk '{split ($1, a, "_"); print a[1] "\t" $2 "\t" $3}' | bedtools merge -i - > g4s_inNewRegionsT2T.modified.bed

# for intersecting it to g4 annotations
for i in {1..23} X Y; do bedtools intersect -a ../../g4set_fork/Pan_paniscus/chr${i}.pqsfinder.filtered.bed -b g4s_inNewRegionsT2T.modified.bed -wa -wb > chr${i}.g4sinNewRegions.bed; done;

# to get the total G4s
for i in {1..23} X Y; do cat chr${i}.g4sinNewRegions.bed | wc -l | awk -v chr=$i '{print "chr"chr "\t" $1}' >> newG4sinnewRegions.dat; done;

# to get the sum of total newly resolved regions
for i in {1..23} X Y; do cat g4s_inNewRegionsT2T.modified.bed | grep "^chr$i[^0-9]" | awk -v chr=$i '{sum += $3-$2; } END {print "chr"chr "\t" sum;}' >> newRegions.dat; done;

# remove the chromosome bed files
rm -f chr*.bed
